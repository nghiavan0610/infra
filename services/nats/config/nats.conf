# =============================================================================
# NATS Server Configuration
# =============================================================================
# Production-ready configuration for NATS with JetStream
#
# Manage tenants/users with: ./manage.sh
# =============================================================================

# -----------------------------------------------------------------------------
# Server
# -----------------------------------------------------------------------------
server_name: $NATS_SERVER_NAME
host: 0.0.0.0
port: 4222
http_port: 8222

# -----------------------------------------------------------------------------
# Authentication
# -----------------------------------------------------------------------------
include "auth.conf"

# -----------------------------------------------------------------------------
# Connection Limits
# -----------------------------------------------------------------------------
max_connections: 10000
max_payload: 1MB
max_pending: 64MB
max_subscriptions: 0  # unlimited

# -----------------------------------------------------------------------------
# Timeouts
# -----------------------------------------------------------------------------
ping_interval: 20s
ping_max: 3
write_deadline: 10s

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
logtime: true
logtime_utc: true
debug: false
trace: false

# -----------------------------------------------------------------------------
# JetStream
# -----------------------------------------------------------------------------
jetstream {
    store_dir: /data/jetstream
    max_memory_store: 256MB
    max_file_store: 10GB
    sync_interval: 1s
}

# -----------------------------------------------------------------------------
# TLS (uncomment for production with certs)
# -----------------------------------------------------------------------------
# tls {
#     cert_file: /etc/nats/certs/server.crt
#     key_file: /etc/nats/certs/server.key
#     ca_file: /etc/nats/certs/ca.crt
#     verify: true
#     timeout: 2
# }

# -----------------------------------------------------------------------------
# Cluster (uncomment for HA setup)
# -----------------------------------------------------------------------------
# cluster {
#     name: nats-cluster
#     host: 0.0.0.0
#     port: 6222
#     routes: [
#         nats://nats-1:6222
#         nats://nats-2:6222
#         nats://nats-3:6222
#     ]
# }
