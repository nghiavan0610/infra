# =============================================================================
# MongoDB Replica Set Configuration
# =============================================================================
# Copy this file to .env and update the values
# DO NOT commit .env to version control!
# =============================================================================

# -----------------------------------------------------------------------------
# Replica Set Configuration
# -----------------------------------------------------------------------------
MONGO_REPLICA_SET_NAME=rs0

# Primary node (highest priority, will be elected as primary)
MONGO_PRIMARY_HOST=mongo-primary
MONGO_PRIMARY_PORT=27017

# Secondary node (lower priority, can become primary if primary fails)
MONGO_SECONDARY_HOST=mongo-secondary
MONGO_SECONDARY_PORT=27018

# Arbiter node (voting only, no data - for odd number of voters)
MONGO_ARBITER_HOST=mongo-arbiter
MONGO_ARBITER_PORT=27019

# External IPs (for client connections from outside Docker network)
# Set to your server's public IP or use host.docker.internal for local dev
MONGO_EXTERNAL_HOST=host.docker.internal

# -----------------------------------------------------------------------------
# Authentication
# -----------------------------------------------------------------------------
# Root admin user (for database administration)
MONGO_INITDB_ROOT_USERNAME=admin
# Generate with: openssl rand -base64 24
MONGO_INITDB_ROOT_PASSWORD=CHANGE_ME_STRONG_PASSWORD

# Application user (for your application connections)
MONGO_APP_USERNAME=app
# Generate with: openssl rand -base64 24
MONGO_APP_PASSWORD=CHANGE_ME_APP_PASSWORD
MONGO_APP_DATABASE=myapp

# Exporter user (for Prometheus mongodb_exporter)
MONGO_EXPORTER_USERNAME=exporter
# Generate with: openssl rand -base64 24
MONGO_EXPORTER_PASSWORD=CHANGE_ME_EXPORTER_PASSWORD

# -----------------------------------------------------------------------------
# TLS Configuration
# -----------------------------------------------------------------------------
# Set to 'requireTLS' for production, 'preferTLS' for development
MONGO_TLS_MODE=requireTLS

# For production with valid certificates, set both to false
# For development with self-signed certs, set to true
MONGO_TLS_ALLOW_INVALID_HOSTNAMES=false
MONGO_TLS_ALLOW_INVALID_CERTIFICATES=false

# -----------------------------------------------------------------------------
# Resource Limits (adjust based on your VPS)
# -----------------------------------------------------------------------------
# Small VPS (4GB RAM) - Single replica recommended
# MONGO_PRIMARY_MEMORY_LIMIT=1G
# MONGO_PRIMARY_CACHE_SIZE_GB=0.25
# MONGO_SECONDARY_MEMORY_LIMIT=1G
# MONGO_SECONDARY_CACHE_SIZE_GB=0.25

# Medium VPS (8-16GB RAM) - DEFAULT
MONGO_PRIMARY_MEMORY_LIMIT=2G
MONGO_PRIMARY_MEMORY_RESERVATION=512M
MONGO_PRIMARY_CACHE_SIZE_GB=0.5
MONGO_SECONDARY_MEMORY_LIMIT=2G
MONGO_SECONDARY_MEMORY_RESERVATION=512M
MONGO_SECONDARY_CACHE_SIZE_GB=0.5
MONGO_ARBITER_MEMORY_LIMIT=256M
MONGO_ARBITER_MEMORY_RESERVATION=64M

# Large VPS (32GB+ RAM)
# MONGO_PRIMARY_MEMORY_LIMIT=8G
# MONGO_PRIMARY_CACHE_SIZE_GB=4
# MONGO_SECONDARY_MEMORY_LIMIT=8G
# MONGO_SECONDARY_CACHE_SIZE_GB=4

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
# Options: 0 (quiet), 1 (default), 2-5 (verbose)
MONGO_VERBOSITY=0

# Log destination: file or syslog
MONGO_LOG_DESTINATION=file

# -----------------------------------------------------------------------------
# Performance Tuning
# -----------------------------------------------------------------------------
# Connection pool size
MONGO_MAX_CONNECTIONS=1000

# Operation profiling (0=off, 1=slow ops, 2=all ops)
MONGO_PROFILING_LEVEL=1
MONGO_SLOW_OP_THRESHOLD_MS=100

# -----------------------------------------------------------------------------
# Backup Configuration
# -----------------------------------------------------------------------------
# Backup retention in days
MONGO_BACKUP_RETENTION_DAYS=7

# Backup schedule (cron format) - if using scheduled backups
# MONGO_BACKUP_SCHEDULE="0 2 * * *"

# -----------------------------------------------------------------------------
# Monitoring (for Prometheus integration)
# -----------------------------------------------------------------------------
MONGO_EXPORTER_PORT=9216

# =============================================================================
# Connection Strings (after deployment):
# =============================================================================
# Internal (from Docker network):
#   mongodb://app:password@mongo-primary:27017,mongo-secondary:27018/myapp?replicaSet=rs0&tls=true
#
# External (from host or other servers):
#   mongodb://app:password@host.docker.internal:27017,host.docker.internal:27018/myapp?replicaSet=rs0&tls=true
#
# With TLS CA file:
#   mongodb://app:password@mongo-primary:27017/myapp?replicaSet=rs0&tls=true&tlsCAFile=/path/to/ca.pem
# =============================================================================
